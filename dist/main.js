var Client;(()=>{"use strict";var e={d:(t,n)=>{for(var a in n)e.o(n,a)&&!e.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:n[a]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};function n(e){let t=(new Date).getTime(),n=0,a=864e5;return n=new Date(e).getTime()-t,console.log(Math.floor(n/a)),Math.floor(n/a)}e.r(t),e.d(t,{get:()=>h,postData:()=>I,updateUI:()=>w});const a="http://api.geonames.org/searchJSON?q=",o="&maxRows=1&username=mslmyilmaz34",i="&key=acd17ba58e474ea784b6ee173682b12c",c="?key=18966273-08e660e3cb740ecdc01bf4ebe",r=document.getElementById("saved-trip-image"),l=document.getElementById("saved-city"),m=document.getElementById("saved-temp"),d=document.getElementById("saved-description"),s=document.getElementById("saved-icon");class g{constructor(e,t,n,a,o){l.innerHTML=e,m.innerHTML=a,s.src=t,d.innerHTML=n,r.style.backgroundImage=`url('${o}')`}}document.getElementById("city");const p=document.getElementById("date-picker"),y=document.querySelector(".card__inner"),u=document.querySelector(".go-back");async function h(e){try{const t=await fetch(e);return await t.json()}catch(e){console.error("err",e)}}window.addEventListener("DOMContentLoaded",(e=>{n(),null==localStorage.getItem("trip")&&localStorage.setItem("trip",null);let t=JSON.parse(localStorage.getItem("trip"));new g(t.city,t.icon,t.description,t.temp,t.image)})),document.getElementById("generate").addEventListener("click",(function(e){if(console.log(p.value),n(p.value)<=7&&n(p.value)>=0)h(`${a}${city.value}${o}`).then((e=>{h(`https://api.weatherbit.io/v2.0/current?lat=${e.geonames[0].lat}&lon=${e.geonames[0].lng}${i}&include=minutely`).then((t=>{h(`https://pixabay.com/api/${c}&q=${t.data[0].city_name}&image_type=photo`).then((a=>{console.log("I am daily"),I("/create",{city:e.geonames[0].name,date:n(p.value),temp:t.data[0].temp,icon:t.data[0].weather.icon,description:t.data[0].weather.description,image:a.hits[0].largeImageURL})})).then((()=>w()))}))}));else{if(!(n(p.value)>7))return;h(`${a}${city.value}${o}`).then((e=>{h(`https://api.weatherbit.io/v2.0/forecast/daily?lat=${e.geonames[0].lat}&lon=${e.geonames[0].lng}${i}`).then((t=>{h(`https://pixabay.com/api/${c}&q=${e.geonames[0].name}&image_type=photo`).then((a=>{console.log(t.data[0]),I("/create",{city:e.geonames[0].name,date:n(p.value),temp:(t.data[0].app_max_temp+t.data[0].app_min_temp)/2,icon:t.data[0].weather.icon,description:t.data[0].weather.description,image:a.hits[0].largeImageURL})})).then((()=>w()))}))}))}}));const I=async(e="",t={})=>{const n=await fetch(e,{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});try{await n.json()}catch(e){console.log("error",e)}},v=(document.getElementById("date"),document.getElementById("temp"),document.getElementById("content"),document.getElementById("resCity")),$=document.getElementById("description");let b=document.querySelector(".image-icon");const f=document.getElementById("place-image"),w=async()=>{const e=await h("/all");try{v.innerHTML=`${e.city} is ${e.date} days away`,b.src=`../icons/${e.icon}.png`,$.innerHTML=e.description,temp.innerHTML=`${e.temp}Â°`,f.style.backgroundImage=`url('${e.image}')`;let t={city:e.city,icon:`../icons/${e.icon}.png`,description:e.description,temp:e.temp,image:e.image};localStorage.setItem("trip",JSON.stringify(t)),y.classList.toggle("is-flipped")}catch(e){console.log("error",e)}};u.addEventListener("click",(()=>{let e=JSON.parse(localStorage.getItem("trip"));new g(e.city,e.icon,e.description,e.temp,e.image),y.classList.toggle("is-flipped")})),Client=t})();